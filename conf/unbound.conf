# Arquivo de configuração do Unbound DNS Server 
# Otimizado para desempenho e segurança

server:
    # Configurações Básicas
    verbosity: 1
    num-threads: 4  # Ajuste conforme número de CPUs disponíveis
    interface: 0.0.0.0
    port: 53
    do-ip4: yes
    do-ip6: yes
    do-udp: yes
    do-tcp: yes
    
    # Controle de acesso
    access-control: 127.0.0.0/8 allow
    access-control: 192.168.0.0/16 allow
    access-control: 10.0.0.0/8 allow
    # access-control: 0.0.0.0/0 refuse  # Descomente para bloquear qualquer outro acesso
    
    # Otimizações de desempenho
    prefetch: yes
    prefetch-key: yes
    msg-cache-size: 128m
    rrset-cache-size: 256m
    cache-min-ttl: 0
    cache-max-ttl: 86400
    
    # Configurações de proteção
    hide-identity: yes
    hide-version: yes
    use-caps-for-id: yes
    harden-glue: yes
    harden-dnssec-stripped: yes
    
    # Limite de recursos
    outgoing-range: 8192
    num-queries-per-thread: 4096
    
    # Configuração de forwarding (opcional)
    # forwarding
    # forward-zone:
    #    name: "."
    #    forward-addr: 8.8.8.8
    #    forward-addr: 1.1.1.1
    
    # DNSSEC
    auto-trust-anchor-file: "/var/lib/unbound/root.key"
    val-clean-additional: yes
    
    # Estatísticas e monitoramento
    extended-statistics: yes
    statistics-interval: 0
    statistics-cumulative: yes
    
    # Controle remoto (para unbound-control)
    control-enable: yes
    control-interface: 127.0.0.1
    # Para segurança adicional, gere estes arquivos com unbound-control-setup
    control-use-cert: yes
    control-key-file: "/etc/unbound/unbound_control.key"
    control-cert-file: "/etc/unbound/unbound_control.pem"
    server-key-file: "/etc/unbound/unbound_server.key"
    server-cert-file: "/etc/unbound/unbound_server.pem"

# Configuração de cache local (opcional - requer pacote unbound-anchor)
# python:
#    python-script: "/etc/unbound/ublocklist.py"